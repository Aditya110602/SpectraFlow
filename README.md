# SpectraFlow: Spectra Analysis Platform

[](https://www.python.org/downloads/)

SpectraFlow is a desktop application built with Python and `ttkbootstrap` for processing, analyzing, and visualizing spectrometer data. It provides a multi-tab interface for handling raw signal processing, combining batch statistics, and performing quality control on absorbance data.

This platform is designed to streamline the workflow from raw instrument data to final analysis, combining complex signal processing (via `scipy` and `numpy`) with a modern, user-friendly graphical interface.

## ðŸ“¸ Screenshots

*(This section is a placeholder. You should add your own screenshots to show the application's interface.)*

| Stats Process Tab | Combine & Plot Stats Tab | Cleaning Test Tab |
| :---: | :---: | :---: |
| \[*Image of the 'Stats Process' tab*] | \[*Image of the 'Combine & Plot' tab*] | \[*Image of the 'Cleaning Test' QC plot*] |

## âœ¨ Features

The application is divided into three main modules:

### 1\. Stats Process (`app1_processor.py`)

This tab is the main engine for processing raw signal files.

  * **Data Input:** Reads raw IR and Laser signal data (`.txt` files) from a specified folder based on a range of Sample IDs.
  * **Advanced Signal Processing:**
      * Applies FIR and Butterworth filters for noise reduction.
      * Finds centerbursts and peaks in the IR signal.
      * Performs signal upsampling and interpolation using Cubic Spline.
      * Applies Forman phase correction for signal symmetrization.
  * **Statistics Generation:** Calculates and saves detailed statistics (`_stats.xlsx`) for each signal, including:
      * Signal-to-Noise Ratio (SNR)
      * Zero-crossing mean, std, and frequency
      * Peak amplitude (raw and filtered)
      * Peak slope and distance metrics
  * **Output:** Generates processed interferogram files (`_ifg_...xlsx`) and the detailed stats files.

### 2\. Combine & Plot Stats (`app2_viewer.py`)

This tab is for aggregating and visualizing the results from the "Stats Process" module.

  * **File Aggregation:** Scans a folder for multiple `_stats.xlsx` files generated by the first tab.
  * **Data Combination:** Merges all found stats files into a single master file: `Combined_Stability_Stats.xlsx`.
  * **Visualization:**
      * Generates a line plot and a scatter plot for user-selected columns (e.g., `final_amp`, `up_laser_zc_std`).
      * Helps visualize trends and stability across a batch of samples.
      * Saves the generated plot as a `.jpg` in the processed folder.

### 3\. Cleaning Test (`app3_cleaning_data.py`)

This tab serves as a separate Quality Control (QC) tool for absorbance data.

  * **File Concatenation:** Finds and combines multiple `_sample_abs_...csv` files from a folder.
  * **QC Plotting:**
      * Plots all samples on a single `matplotlib` graph with pre-defined pass/fail thresholds.
      * Overlays a "Cleaning Successful" or "Cleaning Unsuccessful Repeat Cleaning" message based on how many samples pass the thresholds.
  * **Output:** Automatically saves the QC plot as `Cleaning.png` in the source folder for easy review.

## ðŸ“¦ Installation

To run this application, you need to have Python 3 installed, along with several key libraries.

1.  **Clone the repository:**

    ```bash
    git clone https://github.com/your-username/SpectraFlow.git
    cd SpectraFlow
    ```

2.  **Create a virtual environment** (recommended):

    ```bash
    python -m venv venv
    source venv/bin/activate  # On Windows, use `venv\Scripts\activate`
    ```

3.  **Install the dependencies:**
    You can create a `requirements.txt` file with the content below and install it.

    **`requirements.txt`**

    ```
    ttkbootstrap
    pandas
    numpy
    scipy
    matplotlib
    scikit-learn
    openpyxl
    plotly
    ```

    Install the requirements:

    ```bash
    pip install -r requirements.txt
    ```

## ðŸš€ Usage

To run the application, execute the main `SpectraFlow.py` file:

```bash
python SpectraFlow.py
```

### Tab 1: Stats Process

1.  Click **"Browse"** to select the folder containing your raw `.txt` signal files.
2.  Enter the **"Machine ID"** (this will be part of the output folder's name).
3.  Enter the **"Sample ID Start"** and **"Sample ID End"** to define the range of files to process.
4.  Click **"â–¶ START Processing"**.
5.  The log box will show the processing status for each sample.
6.  A new folder (e.g., `MACHINE-ID_2025-10-30_14-30-00`) will be created in your read path, containing all the output `.xlsx` files.

### Tab 2: Combine & Plot Stats

1.  Click **"ðŸ“‚ Select Stats Folder & Combine Files"**.
2.  Choose the output folder created by the "Stats Process" tab (the one containing all the `_stats.xlsx` files).
3.  The app will create a `Combined_Stability_Stats.xlsx` file in that same folder.
4.  Once combined, select the columns you wish to plot from the dropdown menus.
5.  Click **"ðŸ“ˆ Generate & Save Plots"** to view the plots and save them as a `.jpg` file.

### Tab 3: Cleaning Test

1.  Click **"Browse"** and select the folder that contains your `_sample_abs_...csv` files.
2.  Click **"Process & Plot"**.
3.  The plot will appear in the GUI, showing the QC results.
4.  A `Cleaning.png` image file will be automatically saved in the folder you selected.

## ðŸ“‚ File Structure

```
SpectraFlow/
â”‚
â”œâ”€â”€ SpectraFlow.py           # Main application launcher, creates the notebook (tabs)
â”œâ”€â”€ app1_processor.py        # Module for the "Stats Process" tab
â”œâ”€â”€ app2_viewer.py           # Module for the "Combine & Plot Stats" tab
â”œâ”€â”€ app3_cleaning_data.py    # Module for the "Cleaning Test" tab
â””â”€â”€ requirements.txt         # List of dependencies
```

## License

This project is licensed under the MIT License. See the `LICENSE` file for details.
